var APF={log:function(A){}};APF.Namespace={register:function(D){var C=D.split(".");var A=window;for(var B=0;B<C.length;B++){if(typeof A[C[B]]=="undefined"){A[C[B]]=new Object()}A=A[C[B]]}}};APF.Utils={getWindowSize:function(){var B=0,A=0;if(typeof (window.innerWidth)=="number"){B=window.innerWidth;A=window.innerHeight}else{if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)){B=document.documentElement.clientWidth;A=document.documentElement.clientHeight}else{if(document.body&&(document.body.clientWidth||document.body.clientHeight)){B=document.body.clientWidth;A=document.body.clientHeight}}}return{width:B,height:A}},getScroll:function(){var B=0,A=0;if(typeof (window.pageYOffset)=="number"){A=window.pageYOffset;B=window.pageXOffset}else{if(document.body&&(document.body.scrollLeft||document.body.scrollTop)){A=document.body.scrollTop;B=document.body.scrollLeft}else{if(document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)){A=document.documentElement.scrollTop;B=document.documentElement.scrollLeft}}}return{left:B,top:A}},setCookie:function(C,E,A,H,D,G){var B=new Date();B.setTime(B.getTime());if(A){A=A*1000*60*60*24}var F=new Date(B.getTime()+(A));document.cookie=C+"="+escape(E)+((A)?";expires="+F.toGMTString():"")+((H)?";path="+H:"")+((D)?";domain="+D:"")+((G)?";secure":"")},getCookie:function(A){var F=document.cookie.split(";");var B="";var D="";var E="";var C=false;for(i=0;i<F.length;i++){B=F[i].split("=");D=B[0].replace(/^\s+|\s+$/g,"");if(D==A){C=true;if(B.length>1){E=decodeURIComponent(B[1].replace(/^\s+|\s+$/g,""))}return E;break}B=null;D=""}if(!C){return null}},deleteCookie:function(A,C,B){if(this.getCookie(A)){document.cookie=A+"="+((C)?";path="+C:"")+((B)?";domain="+B:"")+";expires=Thu, 01-Jan-1970 00:00:01 GMT"}},setScrollTop:function(A){if(document.body){document.body.scrollTop=A;if(document.body.scrollTop==0){if(document.documentElement){document.documentElement.scrollTop=A}}}else{if(document.documentElement){document.documentElement.scrollTop=A}}},getScrollTop:function(){return document.body?document.body.scrollTop||document.documentElement.scrollTop:document.documentElement.scrollTop},gotoScrollTop:function(D,C){var B=APF.Utils.getScrollTop(),F=0,E=0;var C=C||1;var D=D||0;var A=B>D?1:0;(function(){B=APF.Utils.getScrollTop();F=A?B-D:D-B;E=A?B-F/15*C:B+1+F/15*C;APF.Utils.setScrollTop(E);if(F<=0||B==APF.Utils.getScrollTop()){return }setTimeout(arguments.callee,10)})()}};var soj=function(F,J){var C=/^http:\/\//;var G=(document.getElementById(F)||document).getElementsByTagName("a"),I,B,H,D,A,E=G.length,J=J||"soj";while(E--){if(null!==G[E].getAttribute(J)){G[E].onclick=function(){B=this.href;if(!B.match(C)){return }if(-1!==B.indexOf("from=")){return }I=encodeURIComponent(this.getAttribute(J));H=B.split("#");if(-1!==B.indexOf("?")){A=H[0]+"&from="+I}else{A=H[0]+"?from="+I}D=H.length;if(D>1){for(var K=1;K<D;K++){A+="#"+H[K]}}this.href=A}}}};APF.Namespace.register("aifang.global.header");aifang.global.header.CitySelector=Class.create({initialize:function(D,C,A){this.selector=$(D);this.panelId=C;this.hideTimeout=A;var B=$(C);this.iframe=B.select("iframe").first();this.iframe.setStyle({width:B.getWidth()+"px",height:B.getHeight()+"px"});this.selector.observe("click",function(){window.clearTimeout(this.timeoutHandle);$(this.panelId).show()}.bind(this));B.observe("mouseover",function(){window.clearTimeout(this.timeoutHandle);$(this.panelId).show()}.bind(this));B.observe("mouseout",function(){window.clearTimeout(this.timeoutHandle);this.timeoutHandle=window.setTimeout("$('"+this.panelId+"').hide()",this.hideTimeout)}.bind(this));this.selector.observe("mouseout",function(){window.clearTimeout(this.timeoutHandle);this.timeoutHandle=window.setTimeout("$('"+this.panelId+"').hide()",this.hideTimeout)}.bind(this));var E=this.selector.select("a").first();if(E!=undefined){E.observe("click",function(F){F.preventDefault()})}}});APF.Namespace.register("anjuke.global.search");anjuke.global.search.Autocompleter=Class.create(Ajax.Autocompleter,{initialize:function($super,C,D,B,A){$super(C,D,B,A);this.index=-1;this._fixChineseInputMethodProblem()},_fixChineseInputMethodProblem:function(){var A=window.setInterval(function(){if(this.oldElementValue==this.element.value){return }this.oldElementValue=this.element.value;if(this.observer){clearTimeout(this.observer)}this.observer=setTimeout(this.onObserverEvent.bind(this),0)}.bind(this),this.options.frequency*1000)},selectEntry:function($super){this.oldElementValue=this.element.value;if(this.observer){clearTimeout(this.observer)}$super()},updateChoices:function($super,C){if(!this.changed&&this.hasFocus){this.update.innerHTML=C;Element.cleanWhitespace(this.update);Element.cleanWhitespace(this.update.down());if(this.update.firstChild&&this.update.down().childNodes){this.entryCount=this.update.down().childNodes.length;for(var A=0;A<this.entryCount;A++){var B=this.getEntry(A);B.autocompleteIndex=A;this.addObservers(B)}}else{this.entryCount=0}this.stopIndicator();this.index=-1;if(this.entryCount==1&&this.options.autoSelect){this.selectEntry();this.hide()}else{this.render()}}},onKeyPress:function(A){if(this.observer){clearTimeout(this.observer);this.observer=null}if(this.active){switch(A.keyCode){case Event.KEY_RETURN:if(this.index<0){return }this.selectEntry();Event.stop(A);case Event.KEY_TAB:case Event.KEY_ESC:this.hide();this.active=false;Event.stop(A);return ;case Event.KEY_LEFT:case Event.KEY_RIGHT:return ;case Event.KEY_UP:this.markPrevious();this.render();Event.stop(A);return ;case Event.KEY_DOWN:this.markNext();this.render();Event.stop(A);return }}else{if(A.keyCode==Event.KEY_TAB||A.keyCode==Event.KEY_RETURN||(Prototype.Browser.WebKit>0&&A.keyCode==0)){return }}this.changed=true;this.hasFocus=true},show:function($super){$super();this.update.setStyle({width:this.update.getWidth()-2+"px"})},markPrevious:function(){if(this.index>0){this.index--}else{this.index=this.entryCount-1}this.getEntry(this.index).scrollIntoView(false)},getUpdatedChoices:function($super){this.startIndicator();var B=encodeURIComponent(this.options.paramName)+"="+encodeURIComponent(this.getToken());this.options.parameters=this.options.callback?this.options.callback(this.element,B):B;if(this.options.defaultParams){this.options.parameters+="&"+this.options.defaultParams}var A=new Ajax.Request(this.url,this.options);this.requestingURL=A.url},onComplete:function(A){if(this.requestingURL==A.request.url){this.requestingURL=null;this.updateChoices(A.responseText)}}});anjuke.global.search.SearchSuggestion=Class.create({initialize:function(C,B,A){this.options=A||{};this.element=$(C);this.update=this.options.update?$(this.options.update):this._createUpdateElement();this.url=B;this.useSuggestion=false;this.autocompleter=new anjuke.global.search.Autocompleter(this.element,this.update,this.url,{method:"GET",frequency:0.2,minChars:1,afterUpdateElement:function(D,F){D.value=F.firstDescendant().innerHTML;var E=this._findParentForm(D);if(E){E.submit()}}.bind(this),callback:function(D,E){if(!this.options.onParameters){return E}var F=this.options.onParameters(E);if(F&&"function"==typeof (F.toQueryString)){return F.toQueryString()}else{return F}}.bind(this)})},_findParentForm:function(A){var B=A;while(B){if(B.tagName=="FORM"){break}B=B.parentNode}return B},_createUpdateElement:function(){var A=$(document.createElement("div"));this.options.className=this.options.className||"SearchSuggestion";A.addClassName(this.options.className);var B=this._getInternetExplorerVersion();if(B>0&&B<=7){Element.insert(this.element.getOffsetParent(),{after:A})}else{Element.insert(document.body,{top:A})}return A},_getInternetExplorerVersion:function(){var C=-1;if(navigator.appName=="Microsoft Internet Explorer"){var A=navigator.userAgent;var B=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");if(B.exec(A)!=null){C=parseFloat(RegExp.$1)}}return C}});APF.Namespace.register("aifang.web.global.header");aifang.web.global.header.TuanBar=Class.create({initialize:function(){this.bind_evens()},bind_evens:function(){$("Favorite")&&$("Favorite").observe("click",function(){this.addFavorite()}.bind(this))},addFavorite:function(){var B=document.title,A=document.URL;if(window.sidebar&&"object"==typeof (window.sidebar)&&"function"==typeof (window.sidebar.addPanel)){window.sidebar.addPanel(B,A,"")}else{if(document.all&&"object"==typeof (window.external)){window.external.AddFavorite(A,B)}else{alert("您所使用的浏览器暂不支持此功能，请使用Ctrl+D进行添加")}}},_end:undefined});var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(J){var I="",H,G,F,E,D,C,B,A=0;J=Base64._utf8_encode(J);while(A<J.length){H=J.charCodeAt(A++),G=J.charCodeAt(A++),F=J.charCodeAt(A++),E=H>>2,D=(H&3)<<4|G>>4,C=(G&15)<<2|F>>6,B=F&63,isNaN(G)?C=B=64:isNaN(F)&&(B=64),I=I+this._keyStr.charAt(E)+this._keyStr.charAt(D)+this._keyStr.charAt(C)+this._keyStr.charAt(B)}return I},decode:function(J){var I="",H,G,F,E,D,C,B,A=0;J=J.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(A<J.length){E=this._keyStr.indexOf(J.charAt(A++)),D=this._keyStr.indexOf(J.charAt(A++)),C=this._keyStr.indexOf(J.charAt(A++)),B=this._keyStr.indexOf(J.charAt(A++)),H=E<<2|D>>4,G=(D&15)<<4|C>>2,F=(C&3)<<6|B,I+=String.fromCharCode(H),C!=64&&(I+=String.fromCharCode(G)),B!=64&&(I+=String.fromCharCode(F))}return I=Base64._utf8_decode(I),I},_utf8_encode:function(B){B=B.replace(/\r\n/g,"\n");var A="";for(var D=0;D<B.length;D++){var C=B.charCodeAt(D);C<128?A+=String.fromCharCode(C):C>127&&C<2048?(A+=String.fromCharCode(C>>6|192),A+=String.fromCharCode(C&63|128)):(A+=String.fromCharCode(C>>12|224),A+=String.fromCharCode(C>>6&63|128),A+=String.fromCharCode(C&63|128))}return A},_utf8_decode:function(B){var A="",D=0,C=c1=c2=0;while(D<B.length){C=B.charCodeAt(D),C<128?(A+=String.fromCharCode(C),D++):C>191&&C<224?(c2=B.charCodeAt(D+1),A+=String.fromCharCode((C&31)<<6|c2&63),D+=2):(c2=B.charCodeAt(D+1),c3=B.charCodeAt(D+2),A+=String.fromCharCode((C&15)<<12|(c2&63)<<6|c3&63),D+=3)}return A}};APF.Namespace.register("aifang.web.global");aifang.web.global.UserInfo=Class.create({initialize:function(D,F,B,A,H,G,E,C){this.login_elem=$(D);this.my_info=$("my_info");this.base_url=G;this.base_url_marked="http://my.aifang.com/marked";this.my_base_domain=C;this.city_id=E;this.cookie_value=APF.Utils.getCookie(F);APF.log("this.cookie_value:"+this.cookie_value);if(this.cookie_value){this.render_login_html(B,A,H,C)}else{this.render_html(A,H,E,C)}},show_my_info:function(D,A){var C='<a class="sc" href="'+this.base_url_marked+'" rel="nofollow">我收藏的楼盘</a>',B;if(D&&A!=""){B='<a class="gz" href="'+this.my_base_domain+'" rel="nofollow">最近更新的楼盘<i>'+A+"</i></a>"}else{B='<a class="gz" href="'+this.my_base_domain+'" rel="nofollow">我关注的楼盘</a>'}this.my_info.update(B+C)},render_html:function(A,E,D,B){A+="/?sid=aifang&url="+Base64.encode(document.location.href)+"&cityid="+D;E+="/?sid=aifang&url="+Base64.encode(document.location.href)+"&cityid="+D;var C='<span>您好，欢迎来新安房产网！</span><span class="lr">[<a href="'+A+'" rel="nofollow">登录</a>] &nbsp;&nbsp;[<a class="b33" href="'+E+'" target="_blank" rel="nofollow">注册</a>]</span>|<a href="'+B+'" class="my">我的爱房</a>';this.login_elem.update(C);this.show_my_info(false)},render_login_html:function(ajax_url,login_url,register_url,my_base_domain){ajax_url+="?v="+encodeURIComponent(this.cookie_value);new Ajax.Request(ajax_url,{method:"get",onSuccess:function(transport){var p=eval("("+transport.responseText+")");if(p.is_login==1){var refer=document.location.href;if((refer).substr(0,9)=="http://my"){refer=this.base_url}var logout_url=p.logout_url+"/?sid=aifang&url="+Base64.encode(refer)+"&u="+Math.random();var html='<span>您好，<a href="'+p.user_url+'">'+p.user_name+'</a>，欢迎来到新安房产网！</span><span class="lr">[<a href="'+logout_url+'">退出</a>]</span>|<a href="'+my_base_domain+'" class="my">我的新安房产<i>'+p.my_latest_loupan+"</i></a>";this.login_elem.update(html);this.show_my_info(true,p.my_latest_loupan)}else{this.render_html(login_url,register_url,this.city_id,my_base_domain)}}.bind(this)})},_thend:undefined});(function(){var B=B||{DISPLAY_BAR:true,IS_DEV:document.location.href.indexOf(".dev.")!==-1,show_bete_info:function(){var C=document.getElementsByTagName("body")[0];var E=document.createElement("div"),D=[];E.style.width="180px";E.style.height="45px";E.style.border="1px solid red";E.style.background="#ff9";E.style.position="fixed";E.style.right="5px";if(Prototype&&Prototype.Browser.IE){E.style.position="absolute";(function(){var F="stage_line_"+Math.round(Math.random()*10000),G=document.getElementsByTagName("head")[0],H=document.createElement("style"),I=document.createTextNode("body{background-image:url(about:blank);background-attachment:fixed;} #"+F+'{filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=3, OffY=3, Color="gray", Positive=true);  background-image:url(about:blank);overflow:hidden; zoom:1; bottom:auto;margin-bottom:5px;top:expression(eval(document.documentElement.scrollTop+document.documentElement.clientHeight-this.offsetHeight-(parseInt(this.currentStyle.marginTop,10)||0)-(parseInt(this.currentStyle.marginBottom,10)||0)));}');H.type="text/css";if(H.styleSheet){H.styleSheet.cssText=I.nodeValue}else{H.appendChild(I)}G.appendChild(H);E.id=F})()}else{E.style.bottom="5px"}E.style.padding="8px";E.style.lineHeight="22px";E.style.fontSize="14px";E.style.fontFamily=" \5FAE\8F6F\96C5\9ED1 , \9ED1\4F53";E.style.color="red";E.style.borderRadius="3px";E.style.boxShadow="0px 0px 16px #333";E.style.opacity="0.7";D.push("<div>★ 当前状态为测试环境 ★</div>");D.push('<div><a id="sw_online_standard" href="javascript:;">立即切换到正式环境 &gt;&gt;</a></div>');E.innerHTML=D.join("");C.appendChild(E);Event.observe($("sw_online_standard"),"click",function(){APF.Utils.deleteCookie("beta_auth_token","/","aifang.com");window.location="/"})}};var A=APF.Utils.getCookie("beta_auth_token");if(B.DISPLAY_BAR&&A&&!B.IS_DEV){B.show_bete_info()}})();APF.Utils.htmlspecialchars_decode=function(A){A=A.replace(/&amp;/g,"&");A=A.replace(/&quot;/g,'"');A=A.replace(/&#039;/g,"'");A=A.replace(/&lt;/g,"<");A=A.replace(/&gt;/g,">");return A};APF.Utils.get_sapan_base_url=function(A){var B="http://pic{{host_id}}.ajkimg.com/display/aifang";B=B.replace(/{{host_id}}/,A);return B};APF.Namespace.register("aifang.loupan.index");aifang.loupan.index.Click=Class.create({initialize:function(){}});